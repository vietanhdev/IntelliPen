<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimal Overlay Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .button { background: #007cba; color: white; border: none; padding: 10px 20px; margin: 5px; border-radius: 4px; cursor: pointer; }
        .popup { position: fixed; top: 100px; left: 100px; background: white; border: 2px solid #007cba; padding: 20px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 999999; }
    </style>
</head>
<body>
    <h1>üñãÔ∏è Minimal Overlay Test</h1>
    
    <button class="button" onclick="showMinimalPopup()">Show Minimal Popup</button>
    <button class="button" onclick="hideMinimalPopup()">Hide Popup</button>
    <button class="button" onclick="testGrammarOverlayDirect()">Test Grammar Overlay Direct</button>
    
    <div id="log" style="background: #f5f5f5; padding: 10px; margin: 20px 0; border-radius: 4px; font-family: monospace; font-size: 12px;"></div>

    <script src="content-scripts/grammar-overlay.js"></script>
    
    <script>
        function log(msg) {
            document.getElementById('log').innerHTML += new Date().toLocaleTimeString() + ': ' + msg + '<br>';
            console.log(msg);
        }
        
        function showMinimalPopup() {
            const popup = document.createElement('div');
            popup.className = 'popup';
            popup.id = 'minimal-popup';
            popup.innerHTML = '<h3>‚úÖ Minimal Popup Works!</h3><p>This proves popups can be displayed.</p><button onclick="hideMinimalPopup()">Close</button>';
            document.body.appendChild(popup);
            log('Minimal popup shown');
        }
        
        function hideMinimalPopup() {
            const popup = document.getElementById('minimal-popup');
            if (popup) {
                popup.remove();
                log('Minimal popup hidden');
            }
        }
        
        function testGrammarOverlayDirect() {
            log('Testing grammar overlay directly...');
            
            if (!window.IntelliPenGrammarOverlay) {
                log('‚ùå Grammar overlay not found');
                return;
            }
            
            log('‚úÖ Grammar overlay found');
            
            // Test if overlay container exists
            const container = document.getElementById('intellipen-grammar-overlay');
            log('Container exists: ' + !!container);
            
            if (container) {
                log('Container children before: ' + container.children.length);
            }
            
            // Create a simple popup directly in the container
            if (container) {
                const testPopup = document.createElement('div');
                testPopup.style.cssText = `
                    position: absolute;
                    top: 50px;
                    left: 50px;
                    background: white;
                    border: 2px solid #007cba;
                    padding: 20px;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    pointer-events: auto;
                    z-index: 1000000;
                `;
                testPopup.innerHTML = '<h3>üñãÔ∏è Direct Grammar Overlay Test</h3><p>This is added directly to the overlay container.</p><button onclick="this.parentElement.remove()">Close</button>';
                
                container.appendChild(testPopup);
                log('‚úÖ Test popup added directly to overlay container');
                log('Container children after: ' + container.children.length);
            }
        }
        
        setTimeout(() => {
            log('Page loaded');
            if (window.IntelliPenGrammarOverlay) {
                log('‚úÖ Grammar overlay available');
            } else {
                log('‚ùå Grammar overlay not available');
            }
        }, 1000);
    </script>
</body>
</html>