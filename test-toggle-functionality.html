<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IntelliPen Toggle Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: #f8fafc;
        }
        
        .test-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            margin: 10px 0;
        }
        
        .test-textarea {
            width: 100%;
            height: 120px;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            resize: vertical;
            margin: 10px 0;
        }
        
        .instructions {
            background: #dbeafe;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }
        
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: 500;
        }
        
        .status.success {
            background: #d1fae5;
            color: #065f46;
        }
        
        .status.error {
            background: #fee2e2;
            color: #991b1b;
        }
    </style>
</head>
<body>
    <h1>üñãÔ∏è IntelliPen Toggle Functionality Test</h1>
    
    <div class="instructions">
        <h3>Test Instructions:</h3>
        <ol>
            <li>Load this page with the IntelliPen extension installed</li>
            <li>Open the extension popup (click the extension icon)</li>
            <li>Toggle the "Writing Intelligence" switch on/off</li>
            <li>Observe the visual changes in the text fields below</li>
            <li>Check the browser console for toggle messages</li>
        </ol>
    </div>

    <div class="test-section">
        <h3>Text Input Field</h3>
        <p>This input should show a blue border when writing intelligence is enabled:</p>
        <input type="text" class="test-input" placeholder="Type something here to test writing intelligence..." />
    </div>

    <div class="test-section">
        <h3>Textarea Field</h3>
        <p>This textarea should also show visual indicators when active:</p>
        <textarea class="test-textarea" placeholder="Write a longer text here to test the writing intelligence features..."></textarea>
    </div>

    <div class="test-section">
        <h3>Email Composition</h3>
        <p>Simulate an email composition area:</p>
        <input type="text" class="test-input" placeholder="Subject: " />
        <textarea class="test-textarea" placeholder="Dear [Name],

I hope this email finds you well. I wanted to reach out to discuss...

Best regards,
[Your Name]"></textarea>
    </div>

    <div class="test-section">
        <h3>Content Editable Area</h3>
        <p>This div should also be detected by IntelliPen:</p>
        <div contenteditable="true" class="test-textarea" style="border: 1px solid #d1d5db; padding: 12px; border-radius: 6px;">
            Click here and start typing to test content editable detection...
        </div>
    </div>

    <div id="status" class="status">
        Waiting for IntelliPen extension to initialize...
    </div>

    <script>
        // Simple test script to monitor extension status
        let extensionReady = false;
        let writingIntelligenceEnabled = true;

        // Listen for messages from the extension
        if (typeof chrome !== 'undefined' && chrome.runtime) {
            // Check if extension is available
            chrome.runtime.sendMessage({ type: 'GET_EXTENSION_STATUS' }, (response) => {
                if (chrome.runtime.lastError) {
                    updateStatus('Extension not available or not responding', 'error');
                } else if (response && response.success) {
                    extensionReady = true;
                    writingIntelligenceEnabled = response.data.writingIntelligenceEnabled;
                    updateStatus(`Extension ready! Writing Intelligence: ${writingIntelligenceEnabled ? 'Enabled' : 'Disabled'}`, 'success');
                } else {
                    updateStatus('Extension responded but with error', 'error');
                }
            });
        } else {
            updateStatus('Chrome extension APIs not available', 'error');
        }

        function updateStatus(message, type = '') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
            console.log('IntelliPen Test:', message);
        }

        // Monitor for visual changes in text fields
        function checkForActiveElements() {
            const activeElements = document.querySelectorAll('.intellipen-active');
            if (activeElements.length > 0) {
                updateStatus(`Found ${activeElements.length} active IntelliPen elements`, 'success');
            }
        }

        // Check for active elements every 2 seconds
        setInterval(checkForActiveElements, 2000);

        // Add some sample text to help with testing
        document.addEventListener('DOMContentLoaded', () => {
            console.log('IntelliPen Test Page: Ready for testing');
            
            // Focus on first input to trigger detection
            setTimeout(() => {
                const firstInput = document.querySelector('.test-input');
                if (firstInput) {
                    firstInput.focus();
                    console.log('IntelliPen Test: Focused on first input field');
                }
            }, 1000);
        });
    </script>
</body>
</html>