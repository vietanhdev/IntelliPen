<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chrome AI APIs Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .api-status {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .available { border-left: 4px solid #4CAF50; }
        .unavailable { border-left: 4px solid #f44336; }
        .downloadable { border-left: 4px solid #ff9800; }
        .unknown { border-left: 4px solid #9e9e9e; }
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #005a87; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .test-area {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
        }
        textarea {
            width: 100%;
            height: 100px;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        .result {
            background: #e8f5e8;
            border: 1px solid #4CAF50;
            border-radius: 3px;
            padding: 10px;
            margin: 10px 0;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>Chrome AI APIs Test</h1>
    <p>This page tests the availability and functionality of Chrome's built-in AI APIs.</p>
    
    <div id="api-status">
        <h2>API Status</h2>
        <div id="status-container">
            <p>Loading API status...</p>
        </div>
    </div>

    <div class="test-area">
        <h3>Test Language Model API</h3>
        <textarea id="prompt-input" placeholder="Enter a prompt to test the Language Model API...">Write a short poem about coding</textarea>
        <br>
        <button id="test-language-model" onclick="testLanguageModel()">Test Language Model</button>
        <div id="language-model-result" class="result" style="display: none;"></div>
    </div>

    <div class="test-area">
        <h3>Test Proofreader API</h3>
        <textarea id="proofreader-input" placeholder="Enter text with errors to test the Proofreader API...">I seen him yesterday at the store, and he bought two loafs of bread.</textarea>
        <br>
        <button id="test-proofreader" onclick="testProofreader()">Test Proofreader</button>
        <div id="proofreader-result" class="result" style="display: none;"></div>
    </div>

    <div class="test-area">
        <h3>Test Writer API</h3>
        <textarea id="writer-input" placeholder="Enter a writing prompt to test the Writer API...">Write a professional email to request a meeting</textarea>
        <br>
        <button id="test-writer" onclick="testWriter()">Test Writer</button>
        <div id="writer-result" class="result" style="display: none;"></div>
    </div>

    <div class="test-area">
        <h3>Test Summarizer API</h3>
        <textarea id="summarizer-input" placeholder="Enter text to summarize...">Artificial intelligence (AI) is intelligence demonstrated by machines, in contrast to the natural intelligence displayed by humans and animals. Leading AI textbooks define the field as the study of "intelligent agents": any device that perceives its environment and takes actions that maximize its chance of successfully achieving its goals. Colloquially, the term "artificial intelligence" is often used to describe machines (or computers) that mimic "cognitive" functions that humans associate with the human mind, such as "learning" and "problem solving".</textarea>
        <br>
        <button id="test-summarizer" onclick="testSummarizer()">Test Summarizer</button>
        <div id="summarizer-result" class="result" style="display: none;"></div>
    </div>

    <script>
        // Check API availability
        async function checkAPIAvailability() {
            const apis = [
                { name: 'Language Model', object: 'LanguageModel', key: 'ai.languageModel' },
                { name: 'Summarizer', object: 'Summarizer', key: 'ai.summarizer' },
                { name: 'Writer', object: 'Writer', key: 'ai.writer' },
                { name: 'Rewriter', object: 'Rewriter', key: 'ai.rewriter' },
                { name: 'Proofreader', object: 'Proofreader', key: 'ai.proofreader' },
                { name: 'Translator', object: 'Translator', key: 'ai.translator' }
            ];

            const statusContainer = document.getElementById('status-container');
            statusContainer.innerHTML = '';

            for (const api of apis) {
                const statusDiv = document.createElement('div');
                statusDiv.className = 'api-status';
                
                try {
                    if (api.object in window) {
                        const apiObject = window[api.object];
                        
                        if (typeof apiObject.availability === 'function') {
                            try {
                                const status = await apiObject.availability();
                                statusDiv.className += ` ${status}`;
                                statusDiv.innerHTML = `
                                    <strong>${api.name}</strong>: ${status}
                                    <br><small>Object: window.${api.object}</small>
                                `;
                            } catch (error) {
                                statusDiv.className += ' unavailable';
                                statusDiv.innerHTML = `
                                    <strong>${api.name}</strong>: Error checking availability
                                    <br><small>Error: ${error.message}</small>
                                `;
                            }
                        } else if (typeof apiObject.create === 'function') {
                            statusDiv.className += ' available';
                            statusDiv.innerHTML = `
                                <strong>${api.name}</strong>: Available (no availability check)
                                <br><small>Object: window.${api.object}</small>
                            `;
                        } else {
                            statusDiv.className += ' unavailable';
                            statusDiv.innerHTML = `
                                <strong>${api.name}</strong>: Incomplete API
                                <br><small>Object: window.${api.object}</small>
                            `;
                        }
                    } else {
                        statusDiv.className += ' unavailable';
                        statusDiv.innerHTML = `
                            <strong>${api.name}</strong>: Not found
                            <br><small>Object: window.${api.object}</small>
                        `;
                    }
                } catch (error) {
                    statusDiv.className += ' unavailable';
                    statusDiv.innerHTML = `
                        <strong>${api.name}</strong>: Error
                        <br><small>Error: ${error.message}</small>
                    `;
                }
                
                statusContainer.appendChild(statusDiv);
            }
        }

        // Test Language Model API
        async function testLanguageModel() {
            const button = document.getElementById('test-language-model');
            const result = document.getElementById('language-model-result');
            
            button.disabled = true;
            button.textContent = 'Testing...';
            result.style.display = 'none';
            
            try {
                if (!('LanguageModel' in window)) {
                    throw new Error('LanguageModel API not available');
                }
                
                const availability = await LanguageModel.availability();
                if (availability === 'unavailable') {
                    throw new Error('LanguageModel API is unavailable');
                }
                
                const session = await LanguageModel.create({
                    outputLanguage: 'en'
                });
                const prompt = document.getElementById('prompt-input').value;
                const response = await session.prompt(prompt);
                
                result.textContent = response;
                result.style.display = 'block';
                session.destroy();
                
            } catch (error) {
                result.textContent = `Error: ${error.message}`;
                result.style.display = 'block';
            } finally {
                button.disabled = false;
                button.textContent = 'Test Language Model';
            }
        }

        // Test Proofreader API
        async function testProofreader() {
            const button = document.getElementById('test-proofreader');
            const result = document.getElementById('proofreader-result');
            
            button.disabled = true;
            button.textContent = 'Testing...';
            result.style.display = 'none';
            
            try {
                if (!('Proofreader' in window)) {
                    throw new Error('Proofreader API not available');
                }
                
                const availability = await Proofreader.availability();
                if (availability === 'unavailable') {
                    throw new Error('Proofreader API is unavailable');
                }
                
                const proofreader = await Proofreader.create({
                    expectedInputLanguages: ['en']
                });
                const text = document.getElementById('proofreader-input').value;
                const proofreadResult = await proofreader.proofread(text);
                
                result.textContent = `Corrected: ${proofreadResult.corrected}\n\nCorrections: ${JSON.stringify(proofreadResult.corrections, null, 2)}`;
                result.style.display = 'block';
                proofreader.destroy();
                
            } catch (error) {
                result.textContent = `Error: ${error.message}`;
                result.style.display = 'block';
            } finally {
                button.disabled = false;
                button.textContent = 'Test Proofreader';
            }
        }

        // Test Writer API
        async function testWriter() {
            const button = document.getElementById('test-writer');
            const result = document.getElementById('writer-result');
            
            button.disabled = true;
            button.textContent = 'Testing...';
            result.style.display = 'none';
            
            try {
                if (!('Writer' in window)) {
                    throw new Error('Writer API not available');
                }
                
                const availability = await Writer.availability();
                if (availability === 'unavailable') {
                    throw new Error('Writer API is unavailable');
                }
                
                const writer = await Writer.create({
                    tone: 'professional',
                    format: 'plain-text',
                    length: 'medium'
                });
                const prompt = document.getElementById('writer-input').value;
                const response = await writer.write(prompt);
                
                result.textContent = response;
                result.style.display = 'block';
                writer.destroy();
                
            } catch (error) {
                result.textContent = `Error: ${error.message}`;
                result.style.display = 'block';
            } finally {
                button.disabled = false;
                button.textContent = 'Test Writer';
            }
        }

        // Test Summarizer API
        async function testSummarizer() {
            const button = document.getElementById('test-summarizer');
            const result = document.getElementById('summarizer-result');
            
            button.disabled = true;
            button.textContent = 'Testing...';
            result.style.display = 'none';
            
            try {
                if (!('Summarizer' in window)) {
                    throw new Error('Summarizer API not available');
                }
                
                const availability = await Summarizer.availability();
                if (availability === 'unavailable') {
                    throw new Error('Summarizer API is unavailable');
                }
                
                const summarizer = await Summarizer.create({
                    type: 'key-points',
                    format: 'markdown',
                    length: 'medium'
                });
                const text = document.getElementById('summarizer-input').value;
                const summary = await summarizer.summarize(text);
                
                result.textContent = summary;
                result.style.display = 'block';
                summarizer.destroy();
                
            } catch (error) {
                result.textContent = `Error: ${error.message}`;
                result.style.display = 'block';
            } finally {
                button.disabled = false;
                button.textContent = 'Test Summarizer';
            }
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', () => {
            checkAPIAvailability();
        });
    </script>
</body>
</html>

